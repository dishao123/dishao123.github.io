{"singlePage": ["about", "link"], "startSite": "03/30/2024", "filingNum": "", "onePageListNum": 15, "commentLabelColor": "#006b75", "yearColorList": ["#bc4c00", "#0969da", "#1f883d", "#A333D0"], "i18n": "CN", "themeMode": "manual", "dayTheme": "dark_dimmed", "nightTheme": "icy-dark", "urlMode": "issue", "script": "<script>document.getElementById('cmButton').click();</script>", "style": "", "head": "", "indexScript": "", "indexStyle": "", "bottomText": "\u8f6c\u8f7d\u8bf7\u6ce8\u660e\u51fa\u5904\uff0c\u8c22\u8c22\ud83d\ude18", "showPostSource": 0, "iconList": {}, "UTC": 8, "rssSplit": "sentence", "exlink": {}, "needComment": 1, "allHead": "<script src='/assets/vercount.js'></script><script defer src='https://um.255688.xyz/script.js' data-website-id='16a94ca6-88b7-4f64-afa2-3f1df3157c54'></script>", "title": "\u5e1d\u5c11\u535a\u5ba2", "subTitle": "\u5206\u4eab\u6280\u672f\uff0c\u4eab\u53d7\u751f\u6d3b", "homeUrl": "https://blog.xwdev.com", "faviconUrl": "/favicon.ico", "avatarUrl": "https://avatars.githubusercontent.com/u/58305876?v=4", "GMEEK_VERSION": "last", "email": "dishao@msn.com", "postListJson": {"P3": {"htmlDir": "docs/post/3.html", "labels": ["\u8bb0\u5f55"], "postTitle": "Markdown \u5e38\u7528\u8bed\u6cd5", "postUrl": "post/3.html", "postSourceUrl": "https://github.com/dishao123/dishao123.github.io/issues/3", "commentNum": 0, "wordCount": 3168, "description": "![](https://img.shields.io/badge/Markdown-0096FF) ![](https://img.shields.io/badge/Static_Badge-630DF9)\r\n\u8fd9\u662f\u4e00\u4e2a Markdown \u8bed\u6cd5\u6d4b\u8bd5\u9875\u9762\uff0c\u540c\u65f6\u8bb0\u5f55\u4e2a\u4eba\u5e38\u7528\u8bed\u6cd5\u3002", "top": 0, "createdAt": 1711895833, "style": "", "script": "<script>document.getElementById('cmButton').click();</script>", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "createdDate": "2024-03-31", "dateLabelColor": "#bc4c00"}, "P4": {"htmlDir": "docs/post/4.html", "labels": ["\u5206\u4eab", "shell"], "postTitle": "VPS \u670d\u52a1\u5668\u5e38\u7528\u811a\u672c\u53ca\u5de5\u5177", "postUrl": "post/4.html", "postSourceUrl": "https://github.com/dishao123/dishao123.github.io/issues/4", "commentNum": 0, "wordCount": 8572, "description": "## \u672c\u6587\u8bb0\u5f55\u4e86\u4e00\u4e9b VPS \u670d\u52a1\u5668\u5e38\u7528\u7684\u811a\u672c\u548c\u5de5\u5177\u3002", "top": 0, "createdAt": 1722869790, "style": "", "script": "<script>document.getElementById('cmButton').click();</script>", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "createdDate": "2024-08-05", "dateLabelColor": "#bc4c00"}, "P5": {"htmlDir": "docs/post/5.html", "labels": ["\u8bb0\u5f55"], "postTitle": "Cloudflare CDN \u652f\u6301\u7684\u7aef\u53e3", "postUrl": "post/5.html", "postSourceUrl": "https://github.com/dishao123/dishao123.github.io/issues/5", "commentNum": 0, "wordCount": 155, "description": "\u8bb0\u5f55\u4e00\u4e0b CF \u652f\u6301\u7684\u53cd\u4ee3/\u56de\u6e90\u7aef\u53e3\u5217\u8868\uff0c\u5f00\u5c0f\u9ec4\u4e91\u5fc5\u5907\r\n\r\n## HTTP\r\n\r\n- 80\r\n- 8080\r\n- 8880\r\n- 2052\r\n- 2082\r\n- 2086\r\n- 2095\r\n\r\n## HTTPS\r\n\r\n- 443\r\n- 2053\r\n- 2083\r\n- 2087\r\n- 2096\r\n- 8443\u3002", "top": 0, "createdAt": 1723216964, "style": "", "script": "<script>document.getElementById('cmButton').click();</script>", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "createdDate": "2024-08-09", "dateLabelColor": "#bc4c00"}, "P6": {"htmlDir": "docs/post/6.html", "labels": ["\u5206\u4eab"], "postTitle": "\u7ec8\u4e8e\u7528\u4e0a Follow \u9605\u8bfb\u5668\u4e86", "postUrl": "post/6.html", "postSourceUrl": "https://github.com/dishao123/dishao123.github.io/issues/6", "commentNum": 0, "wordCount": 279, "description": "\u5728\u6b64\u611f\u8c22 NodeSeek \u8bba\u575b\u7684[@enoch](https://www.nodeseek.com/space/9967#/general)\u5927\u4f6c\uff0c\u63d0\u4f9b\u7684\u9080\u8bf7\u7801\r\n\r\n\r\nThis message is used to verify that this feed (feedId:71548139451401216) belongs to me (userId:57778326200220672). Join me in enjoying the next generation information browser https://follow.is.\u3002", "top": 0, "createdAt": 1729606135, "style": "", "script": "<script>document.getElementById('cmButton').click();</script>", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "createdDate": "2024-10-22", "dateLabelColor": "#bc4c00"}, "P7": {"htmlDir": "docs/post/7.html", "labels": ["\u5de5\u5177"], "postTitle": "\u6587\u672c\u5bf9\u6bd4\u5de5\u5177\u6d4f\u89c8\u5668\u4e66\u7b7e\u7248", "postUrl": "post/7.html", "postSourceUrl": "https://github.com/dishao123/dishao123.github.io/issues/7", "commentNum": 0, "wordCount": 1243, "description": "\u4e00\u4e2a\u53ef\u4ee5\u5728\u6d4f\u89c8\u5668\u4e0a\u4f7f\u7528\u7684\u6587\u672c\u5dee\u5f02\u7f16\u8f91\u5668\uff0c\u8fd8\u53ef\u4ee5\u4fdd\u5b58\u5728\u6d4f\u89c8\u5668\u4e66\u7b7e\uff0c\u4e34\u65f6\u7528\u7528\u8fd8\u4e0d\u9519\r\n\r\n\r\n\u4f7f\u7528\u65b9\u6cd5\r\n\r\n1\uff0c\u968f\u4fbf\u6253\u5f00\u4e00\u4e2a\u7f51\u9875\r\n2\uff0c\u7136\u540e\u628a\u7f51\u9875\u4fdd\u5b58\u6210\u4e66\u7b7e\r\n3\uff0c\u628a\u4fdd\u5b58\u7684\u4e66\u7b7e\u7f51\u9875\u5730\u5740\uff0c\u66ff\u6362\u4e3a\u4ee5\u4e0b\u5185\u5bb9\u5373\u53ef\r\n\r\n```html\r\ndata:text/html,<!DOCTYPE html><html lang='zh'><head><script>const editorConfig={language:'plaintext',originalEditable:true,fontSize:20,wordWrap:'on',automaticLayout:true,fontFamily:'\\'JetBrains Mono\\',\\'HarmonyOS Sans SC\\',\\'Cascadia Code\\',\\'Consolas\\',\\'Menlo\\',\\'Twemoji Mozilla\\',\\'monospace\\''};</script><meta charset='UTF-8' /><meta name='viewport' content='width=device-width, initial-scale=1.0' /><title>\u4e34\u65f6\u5dee\u5f02\u7f16\u8f91\u5668</title></head><body><div id='editor-main' style='width:100vw;height:100vh;position:fixed;inset:0;overflow:hidden;'></div><script src='https://fastly.jsdelivr.net/npm/monaco-editor@latest/min/vs/loader.js'></script><script>require.config({paths:{'vs':'https://fastly.jsdelivr.net/npm/monaco-editor@latest/min/vs'}});require(['vs/editor/editor.main'],function(){const editor=monaco.editor.createDiffEditor(document.getElementById('editor-main'),editorConfig);editor.setModel({original:monaco.editor.createModel('','text/plain'),modified:monaco.editor.createModel('','text/plain')});});</script></body></html>\r\n```\r\n\r\n\u5c0f\u6280\u5de7\uff1a\u628a\u4e0a\u65b9\u4ee3\u7801\u5f00\u5934\u4e2d\u7684`language`\u540e\u9762\u7684`plaintext`\uff0c\u4fee\u6539\u4e3a\u4f60\u6240\u4f7f\u7528\u7684\u4ee3\u7801\u8bed\u8a00\uff0c\u4f8b\u5982`html`\uff0c\u5373\u53ef\u9ad8\u4eae\u63d0\u793a\uff0c\u5982\u679c\u4f60\u61c2\u4ee3\u7801\uff0c\u8fd8\u53ef\u4ee5\u81ea\u5b9a\u4e49\u5916\u89c2\uff0c\u5b57\u4f53\u7b49\uff0c\u60f3\u600e\u4e48\u6539\u600e\u4e48\u6539\u3002", "top": 0, "createdAt": 1730197694, "style": "", "script": "<script>document.getElementById('cmButton').click();</script>", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "createdDate": "2024-10-29", "dateLabelColor": "#bc4c00"}, "P8": {"htmlDir": "docs/post/8.html", "labels": ["\u6559\u7a0b"], "postTitle": "PHP \u53d1\u9001\u90ae\u4ef6\u6e90\u7801", "postUrl": "post/8.html", "postSourceUrl": "https://github.com/dishao123/dishao123.github.io/issues/8", "commentNum": 0, "wordCount": 15207, "description": "\u9996\u5148\uff0c\u521b\u5efa\u4e00\u4e2a `index.html` \u6587\u4ef6\r\n\r\n```html\r\n<html>\r\n<head>\r\n<title>Simple Send Mail </title>\r\n</head>\r\n<body>\r\n<h1>Mail Form</h1>\r\n<form name='form1' method='post' action='mail.php'>\r\n<table>\r\n<tr><td><b>To</b></td><td>\r\n<input type='text' name='mailto' size='35'>\r\n</td></tr>\r\n<tr><td><b>Subject</b></td>\r\n<td><input type='text' name='mailsubject' size='35'></td>\r\n</tr>\r\n<tr><td><b>Message</b></td>\r\n<td>\r\n<textarea name='mailbody' cols='50' rows='7'></textarea>\r\n</td>\r\n</tr>\r\n<tr><td colspan='2'>\r\n<input type='submit' name='Submit' value='Send'>\r\n</td>\r\n</tr>\r\n</table>\r\n</form>\r\n</body>\r\n</html>\r\n```\r\n\r\n\u7136\u540e\uff0c\u65b0\u5efa\u4e00\u4e2a `mail.php` \u6587\u4ef6\r\n\r\n```php\r\n<?php \r\n$stm='\u90ae\u4ef6\u5185\u5bb9'; \r\nrequire('smtp.php'); \r\n########################################## \r\n$smtpserver = 'smtp.qq.com';//SMTP\u670d\u52a1\u5668 \r\n$smtpserverport = '465';//SMTP\u670d\u52a1\u5668\u7aef\u53e3 \r\n$smtpusermail = 'XXX@qq.com';//SMTP\u670d\u52a1\u5668\u7684\u7528\u6237\u90ae\u7bb1 \r\n$smtpemailto = 'AAA@qq.com';//\u53d1\u9001\u7ed9\u8c01 \r\n$smtpuser = 'XXX@qq.com';//SMTP\u670d\u52a1\u5668\u7684\u7528\u6237\u5e10\u53f7 \r\n$smtppass = '666';//SMTP\u670d\u52a1\u5668\u7684\u7528\u6237\u5bc6\u7801 \r\n$mailsubject = '666 ';//\u90ae\u4ef6\u4e3b\u9898 \r\n$mailbody = $stm;//\u90ae\u4ef6\u5185\u5bb9 \r\n$mailtype = 'HTML';//\u90ae\u4ef6\u683c\u5f0f\uff08HTML/TXT\uff09,TXT\u4e3a\u6587\u672c\u90ae\u4ef6 \r\n########################################## \r\n$smtp = new smtp($smtpserver,$smtpserverport,true,$smtpuser,$smtppass);//\u8fd9\u91cc\u9762\u7684\u4e00\u4e2atrue\u662f\u8868\u793a\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1,\u5426\u5219\u4e0d\u4f7f\u7528\u8eab\u4efd\u9a8c\u8bc1. \r\n$smtp->debug = TRUE;//\u662f\u5426\u663e\u793a\u53d1\u9001\u7684\u8c03\u8bd5\u4fe1\u606f \r\n$smtp->sendmail($smtpemailto, $smtpusermail, $mailsubject, $mailbody, $mailtype); \r\necho '<script>alert('\u90ae\u4ef6\u53d1\u9001\u6210\u529f');parent.document.ADDUser.cheheh.click();</script>'; \r\nexit; \r\n} \r\n?>\r\n```\r\n\r\n\u6700\u540e\uff0c\u521b\u5efa\u4e00\u4e2a `smtp.php` \u90ae\u4ef6\u7c7b\r\n\r\n```php\r\n<?php \r\nclass smtp \r\n{ \r\n/* Public Variables */ \r\nvar $smtp_port; \r\nvar $time_out; \r\nvar $host_name; \r\nvar $log_file; \r\nvar $relay_host; \r\nvar $debug; \r\nvar $auth; \r\nvar $user; \r\nvar $pass; \r\n/* Private Variables */ \r\nvar $sock; \r\n/* Constractor */ \r\nfunction smtp($relay_host = '', $smtp_port = 25,$auth = false,$user,$pass) \r\n{ \r\n$this->debug = FALSE; \r\n$this->smtp_port = $smtp_port; \r\n$this->relay_host = $relay_host; \r\n$this->time_out = 30; //is used in fsockopen() \r\n$this->auth = $auth;//auth \r\n$this->user = $user; \r\n$this->pass = $pass; \r\n$this->host_name = 'localhost'; //is used in HELO command \r\n$this->log_file = ''; \r\n$this->sock = FALSE; \r\n} \r\n/* Main Function */ \r\nfunction sendmail($to, $from, $subject = '', $body = '', $mailtype, $cc = '', $bcc = '', $additional_headers = '') \r\n{ \r\n$mail_from = $this->get_address($this->strip_comment($from)); \r\n$body = ereg_replace('(^|(\\r\\n))(\\.)', '\\1.\\3', $body); \r\n$header .= 'MIME-Version:1.0\\r\\n'; \r\nif($mailtype=='HTML') \r\n{ \r\n$header .= 'Content-Type:text/html\\r\\n'; \r\n} \r\n$header .= 'To: '.$to.'\\r\\n'; \r\nif ($cc != '') \r\n{ \r\n$header .= 'Cc: '.$cc.'\\r\\n'; \r\n} \r\n$header .= 'From: $from<'.$from.'>\\r\\n'; \r\n$header .= 'Subject: '.$subject.'\\r\\n'; \r\n$header .= $additional_headers; \r\n$header .= 'Date: '.date('r').'\\r\\n'; \r\n$header .= 'X-Mailer:By Redhat (PHP/'.phpversion().')\\r\\n'; \r\nlist($msec, $sec) = explode(' ', microtime()); \r\n$header .= 'Message-ID: <'.date('YmdHis', $sec).'.'.($msec*1000000).'.'.$mail_from.'>\\r\\n'; \r\n$TO = explode(',', $this->strip_comment($to)); \r\nif ($cc != '') \r\n{ \r\n$TO = array_merge($TO, explode(',', $this->strip_comment($cc))); \r\n} \r\nif ($bcc != '') \r\n{ \r\n$TO = array_merge($TO, explode(',', $this->strip_comment($bcc))); \r\n} \r\n$sent = TRUE; \r\nforeach ($TO as $rcpt_to) \r\n{ \r\n$rcpt_to = $this->get_address($rcpt_to); \r\nif (!$this->smtp_sockopen($rcpt_to)) \r\n{ \r\n$this->log_write('Error: Cannot send email to '.$rcpt_to.'\\n'); \r\n$sent = FALSE; \r\ncontinue; \r\n} \r\nif ($this->smtp_send($this->host_name, $mail_from, $rcpt_to, $header, $body)) \r\n{ \r\n$this->log_write('E-mail has been sent to <'.$rcpt_to.'>\\n'); \r\n} \r\nelse \r\n{ \r\n$this->log_write('Error: Cannot send email to <'.$rcpt_to.'>\\n'); \r\n$sent = FALSE; \r\n} \r\nfclose($this->sock); \r\n$this->log_write('Disconnected from remote host\\n'); \r\n} \r\nreturn $sent; \r\n} \r\n/* Private Functions */ \r\nfunction smtp_send($helo, $from, $to, $header, $body = '') \r\n{ \r\nif (!$this->smtp_putcmd('HELO', $helo)) \r\n{ \r\nreturn $this->smtp_error('sending HELO command'); \r\n} \r\n#auth \r\nif($this->auth) \r\n{ \r\nif (!$this->smtp_putcmd('AUTH LOGIN', base64_encode($this->user))) \r\n{ \r\nreturn $this->smtp_error('sending HELO command'); \r\n} \r\nif (!$this->smtp_putcmd('', base64_encode($this->pass))) \r\n{ \r\nreturn $this->smtp_error('sending HELO command'); \r\n} \r\n} \r\nif (!$this->smtp_putcmd('MAIL', 'FROM:<'.$from.'>')) \r\n{ \r\nreturn $this->smtp_error('sending MAIL FROM command'); \r\n} \r\nif (!$this->smtp_putcmd('RCPT', 'TO:<'.$to.'>')) \r\n{ \r\nreturn $this->smtp_error('sending RCPT TO command'); \r\n} \r\nif (!$this->smtp_putcmd('DATA')) \r\n{ \r\nreturn $this->smtp_error('sending DATA command'); \r\n} \r\nif (!$this->smtp_message($header, $body)) \r\n{ \r\nreturn $this->smtp_error('sending message'); \r\n} \r\nif (!$this->smtp_eom()) \r\n{ \r\nreturn $this->smtp_error('sending <CR><LF>.<CR><LF> [EOM]'); \r\n} \r\nif (!$this->smtp_putcmd('QUIT')) \r\n{ \r\nreturn $this->smtp_error('sending QUIT command'); \r\n} \r\nreturn TRUE; \r\n} \r\nfunction smtp_sockopen($address) \r\n{ \r\nif ($this->relay_host == '') \r\n{ \r\nreturn $this->smtp_sockopen_mx($address); \r\n} \r\nelse \r\n{ \r\nreturn $this->smtp_sockopen_relay(); \r\n} \r\n} \r\nfunction smtp_sockopen_relay() \r\n{ \r\n$this->log_write('Trying to '.$this->relay_host.':'.$this->smtp_port.'\\n'); \r\n$this->sock = @fsockopen($this->relay_host, $this->smtp_port, $errno, $errstr, $this->time_out); \r\nif (!($this->sock && $this->smtp_ok())) \r\n{ \r\n$this->log_write('Error: Cannot connenct to relay host '.$this->relay_host.'\\n'); \r\n$this->log_write('Error: '.$errstr.' ('.$errno.')\\n'); \r\nreturn FALSE; \r\n} \r\n$this->log_write('Connected to relay host '.$this->relay_host.'\\n'); \r\nreturn TRUE;; \r\n} \r\nfunction smtp_sockopen_mx($address) \r\n{ \r\n$domain = ereg_replace('^.+@([^@]+)$', '\\1', $address); \r\nif (!@getmxrr($domain, $MXHOSTS)) \r\n{ \r\n$this->log_write('Error: Cannot resolve MX \\''.$domain.'\\'\\n'); \r\nreturn FALSE; \r\n} \r\nforeach ($MXHOSTS as $host) \r\n{ \r\n$this->log_write('Trying to '.$host.':'.$this->smtp_port.'\\n'); \r\n$this->sock = @fsockopen($host, $this->smtp_port, $errno, $errstr, $this->time_out); \r\nif (!($this->sock && $this->smtp_ok())) \r\n{ \r\n$this->log_write('Warning: Cannot connect to mx host '.$host.'\\n'); \r\n$this->log_write('Error: '.$errstr.' ('.$errno.')\\n'); \r\ncontinue; \r\n} \r\n$this->log_write('Connected to mx host '.$host.'\\n'); \r\nreturn TRUE; \r\n} \r\n$this->log_write('Error: Cannot connect to any mx hosts ('.implode(', ', $MXHOSTS).')\\n'); \r\nreturn FALSE; \r\n} \r\nfunction smtp_message($header, $body) \r\n{ \r\nfputs($this->sock, $header.'\\r\\n'.$body); \r\n$this->smtp_debug('> '.str_replace('\\r\\n', '\\n'.'> ', $header.'\\n> '.$body.'\\n> ')); \r\nreturn TRUE; \r\n} \r\nfunction smtp_eom() \r\n{ \r\nfputs($this->sock, '\\r\\n.\\r\\n'); \r\n$this->smtp_debug('. [EOM]\\n'); \r\nreturn $this->smtp_ok(); \r\n} \r\nfunction smtp_ok() \r\n{ \r\n$response = str_replace('\\r\\n', '', fgets($this->sock, 512)); \r\n$this->smtp_debug($response.'\\n'); \r\nif (!ereg('^[23]', $response)) \r\n{ \r\nfputs($this->sock, 'QUIT\\r\\n'); \r\nfgets($this->sock, 512); \r\n$this->log_write('Error: Remote host returned \\''.$response.'\\'\\n'); \r\nreturn FALSE; \r\n} \r\nreturn TRUE; \r\n} \r\nfunction smtp_putcmd($cmd, $arg = '') \r\n{ \r\nif ($arg != '') \r\n{ \r\nif($cmd=='') \r\n{ \r\n$cmd = $arg; \r\n} \r\nelse \r\n{ \r\n$cmd = $cmd.' '.$arg; \r\n} \r\n} \r\nfputs($this->sock, $cmd.'\\r\\n'); \r\n$this->smtp_debug('> '.$cmd.'\\n'); \r\nreturn $this->smtp_ok(); \r\n} \r\nfunction smtp_error($string) \r\n{ \r\n$this->log_write('Error: Error occurred while '.$string.'.\\n'); \r\nreturn FALSE; \r\n} \r\nfunction log_write($message) \r\n{ \r\n$this->smtp_debug($message); \r\nif ($this->log_file == '') \r\n{ \r\nreturn TRUE; \r\n} \r\n$message = date('M d H:i:s ').get_current_user().'['.getmypid().']: '.$message; \r\nif (!@file_exists($this->log_file) || !($fp = @fopen($this->log_file, 'a'))) \r\n{ \r\n$this->smtp_debug('Warning: Cannot open log file \\''.$this->log_file.'\\'\\n'); \r\nreturn FALSE;; \r\n} \r\nflock($fp, LOCK_EX); \r\nfputs($fp, $message); \r\nfclose($fp); \r\nreturn TRUE; \r\n} \r\nfunction strip_comment($address) \r\n{ \r\n$comment = '\\([^()]*\\)'; \r\nwhile (ereg($comment, $address)) \r\n{ \r\n$address = ereg_replace($comment, '', $address); \r\n} \r\nreturn $address; \r\n} \r\nfunction get_address($address) \r\n{ \r\n$address = ereg_replace('([ \\t\\r\\n])+', '', $address); \r\n$address = ereg_replace('^.*<(.+)>.*$', '\\1', $address); \r\nreturn $address; \r\n} \r\nfunction smtp_debug($message) \r\n{ \r\nif ($this->debug) \r\n{ \r\n//echo $message; \r\n} \r\n} \r\n} \r\n?><?php \r\nclass smtp \r\n{ \r\n/* Public Variables */ \r\nvar $smtp_port; \r\nvar $time_out; \r\nvar $host_name; \r\nvar $log_file; \r\nvar $relay_host; \r\nvar $debug; \r\nvar $auth; \r\nvar $user; \r\nvar $pass; \r\n/* Private Variables */ \r\nvar $sock; \r\n/* Constractor */ \r\nfunction smtp($relay_host = '', $smtp_port = 25,$auth = false,$user,$pass) \r\n{ \r\n$this->debug = FALSE; \r\n$this->smtp_port = $smtp_port; \r\n$this->relay_host = $relay_host; \r\n$this->time_out = 30; //is used in fsockopen() \r\n$this->auth = $auth;//auth \r\n$this->user = $user; \r\n$this->pass = $pass; \r\n$this->host_name = 'localhost'; //is used in HELO command \r\n$this->log_file = ''; \r\n$this->sock = FALSE; \r\n} \r\n/* Main Function */ \r\nfunction sendmail($to, $from, $subject = '', $body = '', $mailtype, $cc = '', $bcc = '', $additional_headers = '') \r\n{ \r\n$mail_from = $this->get_address($this->strip_comment($from)); \r\n$body = ereg_replace('(^|(\\r\\n))(\\.)', '\\1.\\3', $body); \r\n$header .= 'MIME-Version:1.0\\r\\n'; \r\nif($mailtype=='HTML') \r\n{ \r\n$header .= 'Content-Type:text/html\\r\\n'; \r\n} \r\n$header .= 'To: '.$to.'\\r\\n'; \r\nif ($cc != '') \r\n{ \r\n$header .= 'Cc: '.$cc.'\\r\\n'; \r\n} \r\n$header .= 'From: $from<'.$from.'>\\r\\n'; \r\n$header .= 'Subject: '.$subject.'\\r\\n'; \r\n$header .= $additional_headers; \r\n$header .= 'Date: '.date('r').'\\r\\n'; \r\n$header .= 'X-Mailer:By Redhat (PHP/'.phpversion().')\\r\\n'; \r\nlist($msec, $sec) = explode(' ', microtime()); \r\n$header .= 'Message-ID: <'.date('YmdHis', $sec).'.'.($msec*1000000).'.'.$mail_from.'>\\r\\n'; \r\n$TO = explode(',', $this->strip_comment($to)); \r\nif ($cc != '') \r\n{ \r\n$TO = array_merge($TO, explode(',', $this->strip_comment($cc))); \r\n} \r\nif ($bcc != '') \r\n{ \r\n$TO = array_merge($TO, explode(',', $this->strip_comment($bcc))); \r\n} \r\n$sent = TRUE; \r\nforeach ($TO as $rcpt_to) \r\n{ \r\n$rcpt_to = $this->get_address($rcpt_to); \r\nif (!$this->smtp_sockopen($rcpt_to)) \r\n{ \r\n$this->log_write('Error: Cannot send email to '.$rcpt_to.'\\n'); \r\n$sent = FALSE; \r\ncontinue; \r\n} \r\nif ($this->smtp_send($this->host_name, $mail_from, $rcpt_to, $header, $body)) \r\n{ \r\n$this->log_write('E-mail has been sent to <'.$rcpt_to.'>\\n'); \r\n} \r\nelse \r\n{ \r\n$this->log_write('Error: Cannot send email to <'.$rcpt_to.'>\\n'); \r\n$sent = FALSE; \r\n} \r\nfclose($this->sock); \r\n$this->log_write('Disconnected from remote host\\n'); \r\n} \r\nreturn $sent; \r\n} \r\n/* Private Functions */ \r\nfunction smtp_send($helo, $from, $to, $header, $body = '') \r\n{ \r\nif (!$this->smtp_putcmd('HELO', $helo)) \r\n{ \r\nreturn $this->smtp_error('sending HELO command'); \r\n} \r\n#auth \r\nif($this->auth) \r\n{ \r\nif (!$this->smtp_putcmd('AUTH LOGIN', base64_encode($this->user))) \r\n{ \r\nreturn $this->smtp_error('sending HELO command'); \r\n} \r\nif (!$this->smtp_putcmd('', base64_encode($this->pass))) \r\n{ \r\nreturn $this->smtp_error('sending HELO command'); \r\n} \r\n} \r\nif (!$this->smtp_putcmd('MAIL', 'FROM:<'.$from.'>')) \r\n{ \r\nreturn $this->smtp_error('sending MAIL FROM command'); \r\n} \r\nif (!$this->smtp_putcmd('RCPT', 'TO:<'.$to.'>')) \r\n{ \r\nreturn $this->smtp_error('sending RCPT TO command'); \r\n} \r\nif (!$this->smtp_putcmd('DATA')) \r\n{ \r\nreturn $this->smtp_error('sending DATA command'); \r\n} \r\nif (!$this->smtp_message($header, $body)) \r\n{ \r\nreturn $this->smtp_error('sending message'); \r\n} \r\nif (!$this->smtp_eom()) \r\n{ \r\nreturn $this->smtp_error('sending <CR><LF>.<CR><LF> [EOM]'); \r\n} \r\nif (!$this->smtp_putcmd('QUIT')) \r\n{ \r\nreturn $this->smtp_error('sending QUIT command'); \r\n} \r\nreturn TRUE; \r\n} \r\nfunction smtp_sockopen($address) \r\n{ \r\nif ($this->relay_host == '') \r\n{ \r\nreturn $this->smtp_sockopen_mx($address); \r\n} \r\nelse \r\n{ \r\nreturn $this->smtp_sockopen_relay(); \r\n} \r\n} \r\nfunction smtp_sockopen_relay() \r\n{ \r\n$this->log_write('Trying to '.$this->relay_host.':'.$this->smtp_port.'\\n'); \r\n$this->sock = @fsockopen($this->relay_host, $this->smtp_port, $errno, $errstr, $this->time_out); \r\nif (!($this->sock && $this->smtp_ok())) \r\n{ \r\n$this->log_write('Error: Cannot connenct to relay host '.$this->relay_host.'\\n'); \r\n$this->log_write('Error: '.$errstr.' ('.$errno.')\\n'); \r\nreturn FALSE; \r\n} \r\n$this->log_write('Connected to relay host '.$this->relay_host.'\\n'); \r\nreturn TRUE;; \r\n} \r\nfunction smtp_sockopen_mx($address) \r\n{ \r\n$domain = ereg_replace('^.+@([^@]+)$', '\\1', $address); \r\nif (!@getmxrr($domain, $MXHOSTS)) \r\n{ \r\n$this->log_write('Error: Cannot resolve MX \\''.$domain.'\\'\\n'); \r\nreturn FALSE; \r\n} \r\nforeach ($MXHOSTS as $host) \r\n{ \r\n$this->log_write('Trying to '.$host.':'.$this->smtp_port.'\\n'); \r\n$this->sock = @fsockopen($host, $this->smtp_port, $errno, $errstr, $this->time_out); \r\nif (!($this->sock && $this->smtp_ok())) \r\n{ \r\n$this->log_write('Warning: Cannot connect to mx host '.$host.'\\n'); \r\n$this->log_write('Error: '.$errstr.' ('.$errno.')\\n'); \r\ncontinue; \r\n} \r\n$this->log_write('Connected to mx host '.$host.'\\n'); \r\nreturn TRUE; \r\n} \r\n$this->log_write('Error: Cannot connect to any mx hosts ('.implode(', ', $MXHOSTS).')\\n'); \r\nreturn FALSE; \r\n} \r\nfunction smtp_message($header, $body) \r\n{ \r\nfputs($this->sock, $header.'\\r\\n'.$body); \r\n$this->smtp_debug('> '.str_replace('\\r\\n', '\\n'.'> ', $header.'\\n> '.$body.'\\n> ')); \r\nreturn TRUE; \r\n} \r\nfunction smtp_eom() \r\n{ \r\nfputs($this->sock, '\\r\\n.\\r\\n'); \r\n$this->smtp_debug('. [EOM]\\n'); \r\nreturn $this->smtp_ok(); \r\n} \r\nfunction smtp_ok() \r\n{ \r\n$response = str_replace('\\r\\n', '', fgets($this->sock, 512)); \r\n$this->smtp_debug($response.'\\n'); \r\nif (!ereg('^[23]', $response)) \r\n{ \r\nfputs($this->sock, 'QUIT\\r\\n'); \r\nfgets($this->sock, 512); \r\n$this->log_write('Error: Remote host returned \\''.$response.'\\'\\n'); \r\nreturn FALSE; \r\n} \r\nreturn TRUE; \r\n} \r\nfunction smtp_putcmd($cmd, $arg = '') \r\n{ \r\nif ($arg != '') \r\n{ \r\nif($cmd=='') \r\n{ \r\n$cmd = $arg; \r\n} \r\nelse \r\n{ \r\n$cmd = $cmd.' '.$arg; \r\n} \r\n} \r\nfputs($this->sock, $cmd.'\\r\\n'); \r\n$this->smtp_debug('> '.$cmd.'\\n'); \r\nreturn $this->smtp_ok(); \r\n} \r\nfunction smtp_error($string) \r\n{ \r\n$this->log_write('Error: Error occurred while '.$string.'.\\n'); \r\nreturn FALSE; \r\n} \r\nfunction log_write($message) \r\n{ \r\n$this->smtp_debug($message); \r\nif ($this->log_file == '') \r\n{ \r\nreturn TRUE; \r\n} \r\n$message = date('M d H:i:s ').get_current_user().'['.getmypid().']: '.$message; \r\nif (!@file_exists($this->log_file) || !($fp = @fopen($this->log_file, 'a'))) \r\n{ \r\n$this->smtp_debug('Warning: Cannot open log file \\''.$this->log_file.'\\'\\n'); \r\nreturn FALSE;; \r\n} \r\nflock($fp, LOCK_EX); \r\nfputs($fp, $message); \r\nfclose($fp); \r\nreturn TRUE; \r\n} \r\nfunction strip_comment($address) \r\n{ \r\n$comment = '\\([^()]*\\)'; \r\nwhile (ereg($comment, $address)) \r\n{ \r\n$address = ereg_replace($comment, '', $address); \r\n} \r\nreturn $address; \r\n} \r\nfunction get_address($address) \r\n{ \r\n$address = ereg_replace('([ \\t\\r\\n])+', '', $address); \r\n$address = ereg_replace('^.*<(.+)>.*$', '\\1', $address); \r\nreturn $address; \r\n} \r\nfunction smtp_debug($message) \r\n{ \r\nif ($this->debug) \r\n{ \r\n//echo $message; \r\n} \r\n} \r\n} \r\n?>\r\n```\r\n\u5b8c\u6210\r\n\r\n> \u4ee3\u7801\u6765\u6e90\u4e8e\u7f51\u7edc\uff0c\u4ec5\u8bb0\u5f55\uff0c\u672a\u6d4b\u8bd5\u3002", "top": 0, "createdAt": 1730827588, "style": "", "script": "<script>document.getElementById('cmButton').click();</script>", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "createdDate": "2024-11-06", "dateLabelColor": "#bc4c00"}, "P9": {"htmlDir": "docs/post/9.html", "labels": ["\u8bb0\u5f55", "vscode"], "postTitle": "VS Code \u5fc5\u5907\u63d2\u4ef6\u8bb0\u5f55", "postUrl": "post/9.html", "postSourceUrl": "https://github.com/dishao123/dishao123.github.io/issues/9", "commentNum": 0, "wordCount": 1632, "description": "\u8bb0\u5f55\u4e00\u4e0b\uff0c\u6b63\u5728\u4f7f\u7528\u7684 VS Code \u63d2\u4ef6\u3002", "top": 0, "createdAt": 1733371767, "style": "<style>.markdown-alert{padding:0.5rem 1rem;margin-bottom:1rem;border-left:.25em solid var(--borderColor-default,var(--color-border-default));}.markdown-alert .markdown-alert-title {display:flex;font-weight:var(--base-text-weight-medium,500);align-items:center;line-height:1;}.markdown-alert>:first-child {margin-top:0;}.markdown-alert>:last-child {margin-bottom:0;}</style><style>.markdown-alert.markdown-alert-note {border-left-color:var(--borderColor-accent-emphasis, var(--color-accent-emphasis));background-color:var(--color-accent-subtle);}.markdown-alert.markdown-alert-note .markdown-alert-title {color: var(--fgColor-accent,var(--color-accent-fg));}</style><style>.markdown-alert.markdown-alert-tip {border-left-color:var(--borderColor-success-emphasis, var(--color-success-emphasis));background-color:var(--color-success-subtle);}.markdown-alert.markdown-alert-tip .markdown-alert-title {color: var(--fgColor-success,var(--color-success-fg));}</style>", "script": "<script>document.getElementById('cmButton').click();</script>", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "createdDate": "2024-12-05", "dateLabelColor": "#bc4c00"}}, "singeListJson": {"P2": {"htmlDir": "docs/link.html", "labels": ["link"], "postTitle": "\u53cb\u60c5\u94fe\u63a5", "postUrl": "link.html", "postSourceUrl": "https://github.com/dishao123/dishao123.github.io/issues/2", "commentNum": 0, "wordCount": 4, "description": "\u6682\u65e0\u53cb\u94fe\u3002", "top": 0, "createdAt": 1711792142, "style": "", "script": "<script>document.getElementById('cmButton').click();</script>", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "createdDate": "2024-03-30", "dateLabelColor": "#bc4c00"}, "P1": {"htmlDir": "docs/about.html", "labels": ["about"], "postTitle": "\u5173\u4e8e", "postUrl": "about.html", "postSourceUrl": "https://github.com/dishao123/dishao123.github.io/issues/1", "commentNum": 0, "wordCount": 2, "description": "\u4f60\u597d\u3002", "top": 0, "createdAt": 1711792012, "style": "", "script": "<script>document.getElementById('cmButton').click();</script>", "head": "", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "createdDate": "2024-03-30", "dateLabelColor": "#bc4c00"}}, "labelColorDict": {"about": "#D9E1B9", "css": "#63C586", "html": "#1569FC", "js": "#DACDF3", "link": "#24A0DD", "shell": "#BE865E", "vscode": "#26C1BC", "\u5206\u4eab": "#7057ff", "\u5de5\u5177": "#8DAC56", "\u6559\u7a0b": "#6B8FBD", "\u7f51\u7ad9": "#537B31", "\u811a\u672c": "#E77AB1", "\u8bb0\u5f55": "#0075ca"}, "displayTitle": "\u5e1d\u5c11\u535a\u5ba2", "ogImage": "https://avatars.githubusercontent.com/u/58305876?v=4", "primerCSS": "<link href='https://mirrors.sustech.edu.cn/cdnjs/ajax/libs/Primer/21.0.7/primer.css' rel='stylesheet' />", "prevUrl": "disabled", "nextUrl": "disabled"}